<!DOCTYPE html>
  <html lang="ru">
    <head>
      <meta charset="utf-8"></meta>
      <title>lab1</title>
      <link rel="stylesheet" href="https://www.x3dom.org/download/dev/x3dom.css"></link>
      <script src="https://www.x3dom.org/download/dev/x3dom.js"></script>
    </head>

    <body>
      <h1>Страх детства</h1>
      <x3d width="1000px" height="700px" style="width: 500px; height: 400px;">
           <scene render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" pickmode="idBuf" dopickpass="true">

            <background backURL='blackBagarti' ></background>



          <script>
          function changeVisibleNode(nodeId)
          {
              var dirLight = document.getElementById("switcher");

              dirLight.setAttribute("whichChoice", nodeId);
              
              if(nodeId == 0)
                document.getElementById("visNode").innerHTML = "PeaceMod";
              else
                document.getElementById("visNode").innerHTML = "HellMode";
          }
          </script>

         


           <switch whichchoice="0" id="switcher" render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1">
            <Group DEF='Peace'>
            <transform translation="0 2 -6" render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" center="0,0,0" rotation="0,0,0,0" scale="1,1,1" scaleorientation="0,0,0,0">
              <shape  render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" ispickable="true">
                      <appearance sorttype="auto" alphaclipthreshold="0.1">
                          <movietexture repeats="false" repeatt="false" loop="true" url="nature1.ogv" scale="true" hidechildren="true" speed="1" pitch="1"></movietexture>
                      </appearance>
                      <box solid="true" ccw="true" usegeocache="true" lit="true" size="20,20,0.001"></box>              
                  </shape>
                </transform>
                <transform  translation='0.7 0.35 0.9' render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" center="0,0,0" rotation="0,0,0,0" scale="1,1,1" scaleorientation="0,0,0,0">
              <shape DEF='RightEyeSphere1' render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" ispickable="true">
                <appearance>
                    <ImageTexture url='yellowmetal.jpg'>
                    </ImageTexture>
                </appearance>
                <Sphere radius="0.45" solid="true" ccw="true" usegeocache="true" lit="true">
                </Sphere>
              </shape>
            </transform>
            <transform translation='-0.7 0.35 0.9' render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" center="0,0,0" rotation="0,0,0,0" scale="1,1,1" scaleorientation="0,0,0,0">
              <shape USE='RightEyeSphere1'> </shape>
            </transform>
            <Sound>
              <audioclip url='Devil.mp3' loop='true' enabled='false'></audioclip>
            </Sound>
          </Group>

          <Group DEF='Hell'>
                <transform translation="0 2 -6" render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" center="0,0,0" rotation="0,0,0,0" scale="1,1,1" scaleorientation="0,0,0,0">
              <shape  render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" ispickable="true">
                      <appearance sorttype="auto" alphaclipthreshold="0.1">
                          <movietexture repeats="false" repeatt="false" loop="true" url="fire.ogv" scale="true" hidechildren="true" speed="1" pitch="1"></movietexture>
                      </appearance>
                      <box solid="true" ccw="true" usegeocache="true" lit="true" size="20,20,0.001"></box>              
                  </shape>
                </transform>
                <transform  translation='0.7 0.35 0.9' render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" center="0,0,0" rotation="0,0,0,0" scale="1,1,1" scaleorientation="0,0,0,0">
              <shape DEF='RightEyeSphere2' render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" ispickable="true">
                <appearance>
                    <ImageTexture url='redmetal2.jpg'>
                    </ImageTexture>
                </appearance>
                <Sphere radius="0.45" solid="true" ccw="true" usegeocache="true" lit="true">
                </Sphere>
              </shape>
            </transform>
            <transform translation='-0.7 0.35 0.9' render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" center="0,0,0" rotation="0,0,0,0" scale="1,1,1" scaleorientation="0,0,0,0">
              <shape USE='RightEyeSphere2'></shape>
            </transform>
            <Sound>
              <AudioClip url='Devil.mp3' enabled='true' loop='true'></AudioClip>
            </Sound>
          </Group>
            </switch>

          <Group DEF='Head'>
            <shape>
              <appearance>
                <ImageTexture url='steelmetal.jpg'>
                </ImageTexture>
              </appearance>
              <box size='3.003 2.003 2.003' height="1" >
              </box>
            </shape>

            <transform translation='0 -0.5 1'>
              <shape>
                <appearance>
                  <ImageTexture url='steelmetal.jpg'></ImageTexture>
                </appearance>
                <box size='3 1 1'>
                </box>
              </shape>
            </transform>

            <transform DEF='LeftBoxEyeTransform' translation='-1.4 0.5 1'>
              <shape DEF='LeftBoxEyeShape'>
                <appearance>
                  <ImageTexture url='steelmetal.jpg'></ImageTexture>
                </appearance>
                <box size='0.2001 1.001 0.5001'>
                </box>
              </shape>
            </transform>

            <transform translation='1.4 0.5 1'>
              <shape USE='LeftBoxEyeShape'></shape>
            </transform>

            <transform translation='0 0.9 1'>
              <shape>
                <appearance>
                  <ImageTexture url='steelmetal.jpg'></ImageTexture>
                </appearance>
                <box size='3.01 0.21 0.51'>
                </box>
              </shape>
            </transform>

            <transform translation='0 0.2 1'>
              <shape>
                <appearance>
                  <ImageTexture url='steelmetal.jpg'></ImageTexture>
                </appearance>
                <box size='0.3 1.3 0.5'>
                </box>
              </shape>
            </transform>

          

            <transform translation='0.7 0.35 1.27'>
              <shape DEF='RightEyePupil'>
                <appearance>
                  <ImageTexture url ='blackmetal2.jpg'>
                  </ImageTexture>
                </appearance>
                <Sphere radius="0.1">
                </Sphere>
              </shape>
            </transform>

            <transform translation='-0.7 0.35 1.27'>
              <shape USE='RightEyePupil'></shape>
            </transform>

            <transform translation='0 -0.5 1.21'>
              <shape>
                <appearance>
                  <ImageTexture url='blackmetal2.jpg'>
                  </ImageTexture>
                </appearance>
                <box size='2.6 0.6 0.6'>
                </box>
              </shape>
            </transform>

            <transform translation='0 0.15 1.40'>
              <shape>
                <appearance>
                  <ImageTexture url='blackmetal2.jpg'>
                  </ImageTexture>
                </appearance>
                <box size='0.5 0.3 0.3'>
                </box>
              </shape>
            </transform>

            <transform translation='0 0.8 1.30'>
              <shape>
                <appearance>
                  <ImageTexture url='blackmetal2.jpg'>
                  </ImageTexture>
                </appearance>
                <box size='0.201 0.401 0.101'>
                </box>
              </shape>
            </transform>

            <transform translation='0.2 0.82 1.3' rotation='0 0 1 5.23599'>
              <shape DEF = 'RightEarBrowBox'>
                <appearance>
                  <ImageTexture url='blackmetal2.jpg'>
                  </ImageTexture>
                </appearance>
                <box size='0.2 0.5 0.1'>
                </box>
              </shape>
            </transform>

            <transform translation='-0.2 0.82 1.3' rotation='0 0 1 1.0472'>
              <shape USE='RightEarBrowBox'></shape>
            </transform>

            <transform DEF='RightEarTransformCylinder' translation='0.5 1.55 0.3' rotation='0 0 1 6.10865'>
              <shape DEF='RightEarCylinder'>
                <appearance>
                    <ImageTexture url='yellowmetal2.jpg'>
                    </ImageTexture>
                </appearance>
                <Cylinder radius="0.3" height="0.4">
                </Cylinder>
              </shape>
            </transform>

            <transform DEF='LeftEarTransformCylinder' translation='-0.5 1.55 0.3' rotation='0 0 1 0.174533'>
              <shape USE='RightEarCylinder'> </shape>
            </transform>

            <transform DEF='RightEarTransformCone' translation='0.293 0.37 0.3' rotation='0 0 1 2.96706'>
              <shape DEF='RightEarCone'>
                <appearance>
                    <ImageTexture url='yellowmetal2.jpg'>
                    </ImageTexture>
                </appearance>
                <Cone bottomRadius="0.3" height="2">
                </Cone>
              </shape>
            </transform>

            <transform DEF='LeftEarTransform' translation='-0.293 0.37 0.3' rotation='0 0 1 3.31613'>
              <shape USE='RightEarCone'></shape>
            </transform>

            <transform DEF='RightEarTransformSphere' translation='0.535 1.75 0.3'>
              <shape DEF='RightEarSphere'>
                <appearance>
                    <ImageTexture url='yellowmetal2.jpg'></ImageTexture>
                </appearance>
                <Sphere radius="0.3">
                </Sphere>
              </shape>
            </transform>

            <transform translation='-0.535 1.75 0.3'>
              <shape USE='RightEarSphere'></shape>
            </transform>

            <transform DEF='RightTeethTransform' translation='0.2 -0.348 1.22'>
              <shape DEF='RightTeethBox'>
                <appearance>
                  <ImageTexture url='whitemetal.jpg'></ImageTexture>
                </appearance>
                <box size='0.3 0.3 0.6'>
                </box>
              </shape>
            </transform>
                  
            <transform DEF='LeftTeethTransform' translation='-0.2 -0.348 1.22'>
              <shape USE='RightTeethBox'></shape>
            </transform>
                </Group>


                <transform translation='0 -1.1 0.15'>
                  <shape>
                    <appearance>
                <ImageTexture url='whitemetal2.jpg'></ImageTexture>
              </appearance>
            <box size='3 0.2 2.3'>
            </box>
                  </shape>
                </transform>

                <transform translation='0 -2.7 0.15'>
                  <shape>
                    <appearance>
                <ImageTexture url='greenmetal.jpg'></ImageTexture>
            </appearance>
            <box size='3 3 2.3'>
            </box>
                  </shape>
                </transform>

                <Group DEF='RightHand'>
                  <transform DEF='TranRightHand' render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" center="0,0,0" translation="0,0,0" rotation="0,0,0,0" scale="1,1,1" scaleorientation="0,0,0,0">
                    <transform translation= '2 -2.5 0.2' rotation = '0 0 1 1.0472'>
                <shape DEF='RightHandCylinderGreen' render="true" bboxcenter="0,0,0" bboxsize="-1,-1,-1" ispickable="true">
                <appearance sorttype="auto" alphaclipthreshold="0.1">
                    <ImageTexture url='greenmetal.jpg'>
                    </ImageTexture>
                </appearance>
                <Cylinder radius="0.5" height="1.8">
                </Cylinder>
              </shape>
              </transform>

              <transform translation='2.5 -2.8 0.2'>
                <shape DEF='RightHandSphere'>
                  <appearance>
                    <ImageTexture url='blackmetal1.jpg'>
                    </ImageTexture>
                  </appearance>
                  <Sphere radius="0.6">
                  </Sphere>
                </shape>
                
              </transform>

              <transform translation='3.4 -3.3 0.2' rotation='0 0 1 1.0472'>
              <shape DEF='RightHandCylinderGray'>
                <appearance>
                  <ImageTexture url='steelmetal.jpg'>
                  </ImageTexture>
                </appearance>
                <Cylinder radius="0.5" height="1.8">
                </Cylinder>
              </shape>
              </transform>

              <transform translation='4.3 -3.8 0.2'>
                <shape DEF='RightWristSphere'>
                  <appearance>
                    <ImageTexture url='blackmetal1.jpg'>
                    </ImageTexture>
                  </appearance>
                  <Sphere radius="0.35">
                  </Sphere>
                </shape>
              </transform>

              <transform translation='4.9 -4 0.24' rotation='0 0 1 -2.0944'>
                  <transform rotation='0 0 1 -1.57' translation='0.1 0 0'> 
                    <transform rotation='1 0 0 2'> 
                            <shape DEF='RightWirstBox'>
                              <appearance>
                            <ImageTexture url='steelmetal.jpg'>
                            </ImageTexture>
                        </appearance>
                        <box size='1 0.2 1.5'>
                        </box> 
                      </shape>
                          </transform>
                        </transform>
                    </transform>

                    <group DEF='RightFingers'>
                    <transform translation='5.899 -3.94 -0.01' rotation='0 0 1 1.047'>
                    <transform rotation='0 0 1 1.57' translation='-0.1 0 0'> 
                      <transform rotation='1 0 0 2'> 
                              <shape DEF='LeftFingerBox'>
                                <appearance>
                            <ImageTexture url='steelmetal.jpg'>
                            </ImageTexture>
                          </appearance>
                        <box size='0.7 0.2 0.3'>
                        </box>
                              </shape>
                            </transform>
                          </transform>
                    </transform>

                        <transform translation='5.65 -4.4 0.23' rotation='0 0 1 1.047'>
                      <transform rotation='0 0 1 1.57' translation='-0.1 0 0'> 
                        <transform rotation='1 0 0 2'> 
                                <shape USE='LeftFingerBox'></shape>
                              </transform>
                            </transform>
                        </transform>

                        <transform translation='5.35 -4.89 0.494' rotation='0 0 1 1.047'>
                      <transform rotation='0 0 1 1.57' translation='-0.1 0 0'> 
                        <transform rotation='1 0 0 2'> 
                                <shape USE='LeftFingerBox'> </shape>
                              </transform>
                            </transform>
                        </transform>

                         <transform translation='4.21 -4.5 0.11' rotation='0 0 1 1.047'>
                      <transform rotation='0 0 1 1.57' translation='-0.1 0 0'> 
                        <transform rotation='1 0 0 2'> 
                          <shape>
                                  <appearance>
                              <ImageTexture url='steelmetal.jpg'>
                              </ImageTexture>
                            </appearance>
                          <box size='0.3 0.7 0.2'>
                          </box>
                                </shape>
                              </transform>
                            </transform>
                      </transform>
                  </group>
              </transform>
          </Group>

              <Group DEF='LeftHand'>
                <transform DEF='TranLeftHand'>
                <transform translation='-2 -2.5 0.2' rotation='0 0 1 2.0944'>
                <shape USE='RightHandCylinderGreen'></shape>
              </transform>

              <transform translation='-2.5 -2.8 0.2'>
                <shape USE='RightHandSphere'></shape>
              </transform>

              <TimeSensor DEF='TIME' cycleInterval='10'> </TimeSensor>
              <TouchSensor DEF='TOUCH' description='Touch to activate'> </TouchSensor>
              <OrientationInterpolator DEF='ORIENT' key='0 0.5 1' keyValue='0 0 1 0, 0 0 1 -1.57, 0 0 1 0'></OrientationInterpolator>
              <OrientationInterpolator DEF='ORIENTWRIST1' key='0 0.5 0.5' keyValue='1 1 0 0, 1 1 0 -2.6, 1 1 0 -2.6'></OrientationInterpolator>
              <OrientationInterpolator DEF='ORIENTWRIST2' key='0 0.5 0.5' keyValue='1 0 0 0, 0 0 1 0.6, 0 0 1 0.6'></OrientationInterpolator>

                <group DEF='LeftHandWithoutGreen'> 
                <transform DEF='LeftHandWithoutCylSphTran' center='-2.5 -2.8 0.2'>
                  <transform translation='-3.4 -3.3 0.2' rotation='0 0 1 2.0944'>
                  <shape USE='RightHandCylinderGray'></shape>
                  </transform>

                  <transform translation='-4.3 -3.8 0.2'>
                    <shape USE="RightWristSphere"></shape>
                  </transform>
                

                  <Group DEF='LeftFingers'>
                    <transform DEF='LeftFingersTran1' center='-4.3 -3.8 0.2'>
                      <transform DEF='LeftFingersTran2' center='-4.3 -3.8 0.2'>
                        <transform translation='-4.9 -4 0.24' rotation='0 0 1 2.0944'>
                            <transform rotation='0 0 1 1.57' translation='-0.1 0 0'> 
                              <transform rotation='1 0 0 2'> 
                                      <shape USE='RightWirstBox'>
                                        <appearance>
                                    <ImageTexture url='steelmetal.jpg'>
                                    </ImageTexture>
                                  </appearance>
                                <box size='1 0.2 1.5'>
                                </box>
                                      </shape>
                                    </transform>
                                  </transform>
                              </transform>

                        
                        <transform translation='-5.899 -3.94 -0.01' rotation='0 0 1 2.0944'>
                            <transform rotation='0 0 1 1.57' translation='-0.1 0 0'> 
                              <transform rotation='1 0 0 2'> 
                                      <shape DEF='LeftFingerBox'>
                                        <appearance>
                                    <ImageTexture url='steelmetal.jpg'>
                                    </ImageTexture>
                                  </appearance>
                                <box size='0.7 0.2 0.3'>
                                </box>
                                      </shape>
                                    </transform>
                                  </transform>
                          </transform>

                          <transform translation='-5.65 -4.4 0.23' rotation='0 0 1 2.0944'>
                            <transform rotation='0 0 1 1.57' translation='-0.1 0 0'> 
                              <transform rotation='1 0 0 2'> 
                                      <shape USE='LeftFingerBox'></shape>
                                    </transform>
                                  </transform>
                          </transform>

                          <transform translation='-5.35 -4.89 0.494' rotation='0 0 1 2.0944'>
                            <transform rotation='0 0 1 1.57' translation='-0.1 0 0'> 
                              <transform rotation='1 0 0 2'> 
                                      <shape USE='LeftFingerBox'></shape>
                                    </transform>
                                  </transform>
                          </transform>

                          <transform translation='-4.21 -4.5 0.11' rotation='0 0 1 2.0944'>
                          <transform rotation='0 0 1 1.57' translation='-0.1 0 0'> 
                            <transform rotation='1 0 0 2'> 
                              <shape>
                                      <appearance>
                                  <ImageTexture url='steelmetal.jpg'>
                                  </ImageTexture>
                                </appearance>
                              <box size='0.3 0.7 0.2'>
                              </box>
                                  </shape>
                                </transform>
                              </transform>
                          </transform>
                      </transform>
                    </transform>
                  </Group>
                </transform>
              </group>

              <ROUTE fromNode='TOUCH' fromField='touchTime' toNode='TIME' toField='startTime'></ROUTE>
              <ROUTE fromNode='TIME' fromField='fraction_changed' toNode='ORIENT' toField='set_fraction'></ROUTE>
              <ROUTE fromNode='ORIENT' fromField='value_changed' toNode='LeftHandWithoutCylSphTran' toField='set_rotation'></ROUTE>

              <ROUTE fromNode='TIME' fromField='fraction_changed' toNode='ORIENTWRIST1' toField='set_fraction'></ROUTE>
              <ROUTE fromNode='ORIENTWRIST1' fromField='value_changed' toNode='LeftFingersTran1' toField='set_rotation'></ROUTE>

              <ROUTE fromNode='TIME' fromField='fraction_changed' toNode='ORIENTWRIST2' toField='set_fraction'></ROUTE>
              <ROUTE fromNode='ORIENTWRIST2' fromField='value_changed' toNode='LeftFingersTran2' toField='set_rotation'></ROUTE>
            </transform>
          </Group>

             <script>   
              function move(point) 
              {document.getElementById("SphereChaser").setAttribute("set_destination", point)};  
            </script>

            <PositionChaser DEF="SphereChaser" id="SphereChaser" duration="1" initialDestination="0 -3.2 1.311"></PositionChaser> 

            <Transform translation="0 5 0" onClick="move(event.hitPnt);">
              <Shape>
                <appearance>
                  <ImageTexture url='whitemetal2.jpg'></ImageTexture>
                </appearance>
                    <IndexedFaceSet coordIndex="0 1 2 -1 "
                            colorIndex="0" colorPerVertex="false" solid="false">
                    <Coordinate point='-1.3 -6.2 1.311, 1.3 -6.2 1.311, 0 -9.2 1.3'>
                    </Coordinate>
                    <Color color='1 1 1'> </Color>
                  </IndexedFaceSet>
              </Shape>
            </Transform>

            <transform translation='0 -4.45 0.15'>
              <shape>
                <appearance>
                  <ImageTexture url='whitemetal2.jpg'></ImageTexture>
                </appearance>
              <box size='3 0.5 2.3'>
              </box>
              </shape>
            </transform>

            <transform DEF ='Sphere' translation='0 -3.2 0.5'>
              <shape>
                <appearance>
                  <ImageTexture url='redmetal.jpg'>
                  </ImageTexture>
                </appearance>
                <Sphere radius="0.3">
                </Sphere>
              </shape>
            </transform>

             <ROUTE fromNode="SphereChaser" fromField="value_changed" toNode="Sphere" toField="set_translation"></ROUTE>

            <transform translation='0 -4.95 0.15'>
                    <shape>
                      <appearance>
                  <ImageTexture url='blackmetal2.jpg'>
                  </ImageTexture>
                </appearance>
              <box size='2.5 0.5 2.3'>
              </box>
                    </shape>
                  </transform>

                  <transform translation='-0.7 -5.4 0.15'>
              <shape DEF='LeftLegCylinder'>
                <appearance>
                  <ImageTexture url='steelmetal.jpg'>
                  </ImageTexture>
                </appearance>
                <Cylinder radius="0.4" height="1.8">
                </Cylinder>
              </shape>
            </transform>

            <transform translation='-0.7 -6.5 0.15'>
              <shape DEF="LeftLegSphere">
                <appearance>
                  <ImageTexture url='blackmetal1.jpg'>
                  </ImageTexture>
                </appearance>
                <Sphere radius="0.5">
                </Sphere>
              </shape>
            </transform>

            <transform translation='-0.7 -6.5 0.15'>
                    <shape DEF='LeftLegBox'>
                      <appearance>
                  <ImageTexture url='steelmetal.jpg'>
                  </ImageTexture>
                </appearance>
              <box size='1 0.6 1.5'></box>
                    </shape>
                  </transform>

            <transform translation='0.7 -5.4 0.15'>
              <shape USE='LeftLegCylinder'></shape>
            </transform>

                  <transform translation='0.7 -6.5 0.15'>
                      <shape USE='LeftLegBox'></shape>
                    </transform>

              <transform translation='0.7 -6.5 0.15'>
                <shape USE="LeftLegSphere"></shape>
              </transform>
          </scene>
        </x3d>

      <div style="margin-left: 420px">
          <b>RabbitMode</b><br></br>
           <input type="range" id="sliderShadowIntesity" min="0" max="1" step="1" value="0" onchange="changeVisibleNode(this.value)"></input>
        <br></br>
        <span id="visNode" style="color:#00CC00">PeaceMod</span>
      </div>

    </body>
  </html>
